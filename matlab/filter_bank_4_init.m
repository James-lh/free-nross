%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Filters bank (initialization)
% version 4
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT:  ---
% OUTPUT: state = created state of filters bank:
%                 state.N
%                 state.freqs
%                 state.HF100_coeff ... state.LF3500_coeff
%                 state.HF100 ... state.LF3500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [state] = filter_bank_2_init

    K = 1.0/32768;
    
    state.freqs = [ 200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800, 2000, 2400, 2800, 3200, 3600, 4000];
    state.N     = length(state.freqs);
    vy          = zeros(1,state.N);
    
    state.LF200_coeff  = K * [
                                201,    201,    197,    188,    174,    156,    132,    105,     73,  ...
                                38,      1,    -39,    -79,   -120,   -160,   -198,   -234,   -267,   ...
                                -295,   -318,   -334,   -343,   -345,   -338,   -323,   -299,   -265, ...
                                -222,   -170,   -108,    -39,     39,    124,    215,    312,    413, ...
                                518,    624,    731,    837,    941,   1042,   1137,   1227,   1309,  ...
                                1383,   1447,   1501,   1543,   1574,   1593,   1599,   1593,   1574, ...
                                1543,   1501,   1447,   1383,   1309,   1227,   1137,   1042,    941, ...
                                837,    731,    624,    518,    413,    312,    215,    124,     39,  ...
                                -39,   -108,   -170,   -222,   -265,   -299,   -323,   -338,   -345,  ...
                                -343,   -334,   -318,   -295,   -267,   -234,   -198,   -160,   -120, ...
                                -79,    -39,      1,     38,     73,    105,    132,    156,    174,  ...
                                188,    197,    201,    201
                            ];
    state.LF200        = my_filter_init(state.LF200_coeff);
    
    state.BF400_coeff  = K * [
                                -209,   -159,   -106,    -56,    -13,     19,     36,     36,     21,  ...
                                -7,    -44,    -85,   -122,   -150,   -161,   -151,   -117,    -56,    ...
                                30,    137,    258,    384,    507,    614,    694,    737,    736,    ...
                                685,    582,    430,    233,      2,   -251,   -509,   -757,   -977,   ...
                                -1152,  -1268,  -1316,  -1287,  -1180,   -999,   -752,   -453,   -117, ...
                                234,    580,    898,   1170,   1378,   1508,   1552,   1508,   1378,   ...
                                1170,    898,    580,    234,   -117,   -453,   -752,   -999,  -1180,  ...
                                -1287,  -1316,  -1268,  -1152,   -977,   -757,   -509,   -251,      2, ...
                                233,    430,    582,    685,    736,    737,    694,    614,    507,   ...
                                384,    258,    137,     30,    -56,   -117,   -151,   -161,   -150,   ...
                                -122,    -85,    -44,     -7,     21,     36,     36,     19,    -13,  ...
                                -56,   -106,   -159,   -209
                            ];
    state.BF400        = my_filter_init(state.BF400_coeff);
    
    state.BF600_coeff  = K * [
                                -95,   -161,   -189,   -181,   -143,    -89,    -37,      0,     12,   ...
                                -4,    -40,    -82,   -114,   -117,    -80,      1,    115,    246,    ...
                                366,    444,    456,    384,    226,     -1,   -267,   -528,   -735,   ...
                                -845,   -826,   -666,   -378,      1,    415,    797,   1080,   1209,  ...
                                1153,    908,    505,     -1,   -531,  -1000,  -1331,  -1464,  -1371,  ...
                                -1063,   -581,      0,    590,   1095,   1435,   1555,   1435,   1095, ...
                                590,      0,   -581,  -1063,  -1371,  -1464,  -1331,  -1000,   -531,   ...
                                -1,    505,    908,   1153,   1209,   1080,    797,    415,      1,    ...
                                -378,   -666,   -826,   -845,   -735,   -528,   -267,     -1,    226,  ...
                                384,    456,    444,    366,    246,    115,      1,    -80,   -117,   ...
                                -114,    -82,    -40,     -4,     12,      0,    -37,    -89,   -143,  ...
                                -181,   -189,   -161,    -95
                            ];
    state.BF600        = my_filter_init(state.BF600_coeff);
    
    state.BF800_coeff  = K * [
                                239,    160,     48,    -55,   -117,   -124,    -89,    -38,     -2,   ...
                                -3,    -37,    -83,   -105,    -76,     16,    149,    278,    344,    ...
                                301,    138,   -115,   -384,   -578,   -613,   -452,   -117,    304,   ...
                                683,    892,    840,    518,      1,   -565,  -1003,  -1165,   -979,   ...
                                -478,    200,    857,   1287,   1347,   1000,    337,   -452,  -1128,  ...
                                -1484,  -1403,   -900,   -121,    703,   1324,   1554,   1324,    703, ...
                                -121,   -900,  -1403,  -1484,  -1128,   -452,    337,   1000,   1347,  ...
                                1287,    857,    200,   -478,   -979,  -1165,  -1003,   -565,      1,  ...
                                518,    840,    892,    683,    304,   -117,   -452,   -613,   -578,   ...
                                -384,   -115,    138,    301,    344,    278,    149,     16,    -76,  ...
                                -105,    -83,    -37,     -3,     -2,    -38,    -89,   -124,   -117,  ...
                                -55,     48,    160,    239
                            ];
    state.BF800        = my_filter_init(state.BF800_coeff);
    
    state.BF1000_coeff  = K * [
                                20,    160,    203,    145,     36,    -57,    -88,    -60,    -15,    ...
                                -1,    -34,    -83,    -94,    -26,    110,    243,    278,    158,    ...
                                -93,   -360,   -493,   -385,    -46,    379,    676,    664,    304,   ...
                                -262,   -763,   -931,   -643,      1,    703,   1112,    996,    373,  ...
                                -478,  -1145,  -1284,   -795,    109,    999,   1435,   1183,    346,  ...
                                -682,  -1402,  -1456,   -805,    242,   1180,   1554,   1180,    242,  ...
                                -805,  -1456,  -1402,   -682,    346,   1183,   1435,    999,    109,  ...
                                -795,  -1284,  -1145,   -478,    373,    996,   1112,    703,      1,  ...
                                -643,   -931,   -763,   -262,    304,    664,    676,    379,    -46,  ...
                                -385,   -493,   -360,    -93,    158,    278,    243,    110,    -26,  ...
                                -94,    -83,    -34,     -1,    -15,    -60,    -88,    -57,     36,   ...
                                145,    203,    160,     20
                            ];
    state.BF1000        = my_filter_init(state.BF1000_coeff);
    
    state.BF1200_coeff  = K * [
                                -245,   -160,     16,    146,    150,     57,    -37,    -61,    -26,  ...
                                1,    -28,    -82,    -80,     26,    178,    242,    115,   -158,     ...
                                -384,   -359,    -39,    384,    592,    379,   -162,   -664,   -735,  ...
                                -261,    467,    931,    753,      0,   -823,  -1112,   -611,    373,  ...
                                1153,   1146,    309,   -796,  -1381,  -1000,    113,   1184,   1444,  ...
                                683,   -581,  -1457,  -1315,   -242,   1009,   1555,   1009,   -242,   ...
                                -1315,  -1457,   -581,    683,   1444,   1184,    113,  -1000,  -1381, ...
                                -796,    309,   1146,   1153,    373,   -611,  -1112,   -823,      0,  ...
                                753,    931,    467,   -261,   -735,   -664,   -162,    379,    592,   ...
                                384,    -39,   -359,   -384,   -158,    115,    242,    178,     26,   ...
                                -80,    -82,    -28,      1,    -26,    -61,    -37,     57,    150,   ...
                                146,     16,   -160,   -245
                            ];
    state.BF1200        = my_filter_init(state.BF1200_coeff);
    
    state.BF1400_coeff  = K * [
                                57,   -159,   -198,    -55,    100,    124,     36,    -37,    -29,     ...
                                3,    -23,    -83,    -65,     76,    210,    150,   -115,   -344,      ...
                                -257,    138,    481,    385,   -139,   -613,   -529,    117,    735,   ...
                                684,    -70,   -840,   -844,      0,    922,   1003,     92,   -978,    ...
                                -1153,   -201,   1004,   1287,    323,   -999,  -1399,   -452,    964,  ...
                                1484,    581,   -900,  -1536,   -703,    811,   1554,    811,   -703,   ...
                                -1536,   -900,    581,   1484,    964,   -452,  -1399,   -999,    323,  ...
                                1287,   1004,   -201,  -1153,   -978,     92,   1003,    922,      0,   ...
                                -844,   -840,    -70,    684,    735,    117,   -529,   -613,   -139,   ...
                                385,    481,    138,   -257,   -344,   -115,    150,    210,     76,    ...
                                -65,    -83,    -23,      3,    -29,    -37,     36,    124,    100,    ...
                                -55,   -198,   -159,     57
                            ];
    state.BF1400        = my_filter_init(state.BF1400_coeff);
    
    state.BF1600_coeff  = K * [
                                227,    160,    -78,   -181,    -59,     89,     89,      0,    -28,    ...
                                4,    -16,    -82,    -47,    117,    193,      0,   -277,   -246,      ...
                                151,    444,    189,   -384,   -549,      0,    642,    527,   -305,    ...
                                -845,   -342,    667,    915,      0,  -1000,   -796,    447,   1209,   ...
                                478,   -909,  -1220,      0,   1280,   1000,   -551,  -1464,   -568,    ...
                                1063,   1403,      0,  -1424,  -1095,    594,   1555,    594,  -1095,   ...
                                -1424,      0,   1403,   1063,   -568,  -1464,   -551,   1000,   1280,  ...
                                0,  -1220,   -909,    478,   1209,    447,   -796,  -1000,      0,      ...
                                915,    667,   -342,   -845,   -305,    527,    642,      0,   -549,    ...
                                -384,    189,    444,    151,   -246,   -277,      0,    193,    117,   ...
                                -47,    -82,    -16,      4,    -28,      0,     89,     89,    -59,    ...
                                -181,    -78,    160,    227
                            ];
    state.BF1600        = my_filter_init(state.BF1600_coeff);
    
    state.BF1800_coeff  = K * [
                                -128,    159,    174,    -55,   -153,    -20,     88,     37,    -19,  ...
                                6,    -10,    -83,    -29,    148,    136,   -150,   -278,     54,     ...
                                395,    138,   -421,   -385,    310,    613,    -54,   -736,   -305,   ...
                                684,    680,   -428,   -963,      0,   1052,    511,   -888,   -978,   ...
                                477,   1270,    104,  -1287,   -724,    999,   1227,   -452,  -1479,   ...
                                -235,   1402,    900,  -1001,  -1379,    362,   1554,    362,  -1379,  ...
                                -1001,    900,   1402,   -235,  -1479,   -452,   1227,    999,   -724, ...
                                -1287,    104,   1270,    477,   -978,   -888,    511,   1052,      0, ...
                                -963,   -428,    680,    684,   -305,   -736,    -54,    613,    310,  ...
                                -385,   -421,    138,    395,     54,   -278,   -150,    136,    148,  ...
                                -29,    -83,    -10,      6,    -19,     37,     88,    -20,   -153,   ...
                                -55,    174,    159,   -128
                            ];
    state.BF1800        = my_filter_init(state.BF1800_coeff);
    
    state.BF2000_coeff  = K * [
                                -187,   -160,    133,    146,    -81,   -112,     37,     61,     -7,  ...
                                6,     -3,    -83,    -10,    164,     49,   -242,   -115,    310,     ...
                                207,   -360,   -321,    385,    452,   -379,   -592,    339,    735,   ...
                                -262,   -870,    148,    987,      0,  -1079,   -176,   1136,    373,  ...
                                -1154,   -583,   1126,    796,  -1053,   -999,    935,   1184,   -776, ...
                                -1339,    581,   1456,   -360,  -1530,    122,   1554,    122,  -1530, ...
                                -360,   1456,    581,  -1339,   -776,   1184,    935,   -999,  -1053,  ...
                                796,   1126,   -583,  -1154,    373,   1136,   -176,  -1079,      0,   ...
                                987,    148,   -870,   -262,    735,    339,   -592,   -379,    452,   ...
                                385,   -321,   -360,    207,    310,   -115,   -242,     49,    164,   ...
                                -10,    -83,     -3,      6,     -7,     61,     37,   -112,    -81,   ...
                                146,    133,   -160,   -187
                            ];
    state.BF2000        = my_filter_init(state.BF2000_coeff);
    
    state.BF2400_coeff  = K * [
                                396,     -1,   -390,    117,    310,   -183,   -187,    169,     66,    ...
                                -73,      0,    -77,     25,    228,   -146,   -321,    332,    313,    ...
                                -526,   -196,    660,     -1,   -681,    210,    575,   -351,   -374,   ...
                                359,    154,   -206,    -12,    -78,     39,    410,   -284,   -669,    ...
                                732,    733,  -1303,   -517,   1859,     -1,  -2246,    759,   2332,    ...
                                -1626,  -2046,   2428,   1401,  -2994,   -498,   3199,   -498,  -2994,  ...
                                1401,   2428,  -2046,  -1626,   2332,    759,  -2246,     -1,   1859,   ...
                                -517,  -1303,    733,    732,   -669,   -284,    410,     39,    -78,   ...
                                -12,   -206,    154,    359,   -374,   -351,    575,    210,   -681,    ...
                                -1,    660,   -196,   -526,    313,    332,   -321,   -146,    228,     ...
                                25,    -77,      0,    -73,     66,    169,   -187,   -183,    310,     ...
                                117,   -390,     -1,    396
                            ];
    state.BF2400        = my_filter_init(state.BF2400_coeff);
    
    state.BF2800_coeff  = K * [
                                -358,      1,    351,   -305,    -54,    295,   -187,    -64,    144,   ...
                                -45,     -1,    -77,     72,    140,   -316,    124,    331,   -508,    ...
                                93,    513,   -596,      1,    614,   -548,   -100,    568,   -375,     ...
                                -137,    335,   -128,    -35,    -78,    113,    253,   -617,    256,   ...
                                732,  -1187,    230,   1354,  -1678,      1,   2026,  -1986,   -408,    ...
                                2630,  -2047,   -927,   3049,  -1851,  -1446,   3199,  -1446,  -1851,   ...
                                3049,   -927,  -2047,   2630,   -408,  -1986,   2026,      1,  -1678,   ...
                                1354,    230,  -1187,    732,    256,   -617,    253,    113,    -78,   ...
                                -35,   -128,    335,   -137,   -375,    568,   -100,   -548,    614,    ...
                                1,   -596,    513,     93,   -508,    331,    124,   -316,    140,      ...
                                72,    -77,     -1,    -45,    144,    -64,   -187,    295,    -54,     ...
                                -305,    351,      1,   -358
                            ];
    state.BF2800        = my_filter_init(state.BF2800_coeff);
    
    state.BF3200_coeff  = K * [
                                285,     -1,   -278,    376,   -247,      1,    186,   -209,    104,     ...
                                0,     -1,    -77,    112,     -1,   -226,    397,   -332,      1,       ...
                                416,   -635,    473,     -1,   -487,    677,   -458,      1,    374,     ...
                                -444,    240,      0,    -55,    -78,    175,      0,   -441,    827,    ...
                                -733,      1,   1033,  -1674,   1332,     -1,  -1608,   2454,  -1852,    ...
                                1,   2046,  -3001,   2183,      0,  -2253,   3199,  -2253,      0,       ...
                                2183,  -3001,   2046,      1,  -1852,   2454,  -1608,     -1,   1332,    ...
                                -1674,   1033,      1,   -733,    827,   -441,      0,    175,    -78,   ...
                                -55,      0,    240,   -444,    374,      1,   -458,    677,   -487,     ...
                                -1,    473,   -635,    416,      1,   -332,    397,   -226,     -1,      ...
                                112,    -77,     -1,      0,    104,   -209,    186,      1,   -247,     ...
                                376,   -278,     -1,    285
                            ];
    state.BF3200        = my_filter_init(state.BF3200_coeff);
    
    state.BF3600_coeff  = K * [
                                -182,      0,    180,   -305,    344,   -296,    187,    -64,    -23,    ...
                                45,     -2,    -77,    141,   -141,     50,    123,   -332,    508,      ...
                                -582,    513,   -303,     -1,    314,   -548,    638,   -568,    375,    ...
                                -137,    -53,    128,    -69,    -78,    221,   -253,     97,    256,    ...
                                -732,   1187,  -1444,   1354,   -854,     -1,   1033,  -1985,   2586,    ...
                                -2630,   2046,   -927,   -483,   1851,  -2839,   3199,  -2839,   1851,   ...
                                -483,   -927,   2046,  -2630,   2586,  -1985,   1033,     -1,   -854,    ...
                                1354,  -1444,   1187,   -732,    256,     97,   -253,    221,    -78,    ...
                                -69,    128,    -53,   -137,    375,   -568,    638,   -548,    314,     ...
                                -1,   -303,    513,   -582,    508,   -332,    123,     50,   -141,      ...
                                141,    -77,     -2,     45,    -23,    -64,    187,   -296,    344,     ...
                                -305,    180,      0,   -182
                            ];
    state.BF3600        = my_filter_init(state.BF3600_coeff);
    
    state.HF4000_coeff  = K * [
                                22,     41,   -102,    156,   -198,    221,   -225,    206,   -167,      ...
                                109,    -38,    -41,    120,   -191,    248,   -283,    293,   -274,     ...
                                227,   -155,     63,     41,   -149,    250,   -333,    390,   -413,     ...
                                397,   -340,    243,   -113,    -42,    208,   -373,    519,   -630,     ...
                                693,   -694,    623,   -476,    253,     42,   -397,    799,  -1229,     ...
                                1665,  -2085,   2466,  -2788,   3031,  -3183,   3235,  -3183,   3031,    ...
                                -2788,   2466,  -2085,   1665,  -1229,    799,   -397,     42,    253,   ...
                                -476,    623,   -694,    693,   -630,    519,   -373,    208,    -42,    ...
                                -113,    243,   -340,    397,   -413,    390,   -333,    250,   -149,    ...
                                41,     63,   -155,    227,   -274,    293,   -283,    248,   -191,      ...
                                120,    -41,    -38,    109,   -167,    206,   -225,    221,   -198,     ...
                                156,   -102,     41,     22
                            ];
    state.HF4000        = my_filter_init(state.HF4000_coeff);

return
