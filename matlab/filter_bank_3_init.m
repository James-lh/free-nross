%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Filters bank (initialization)
% version 3
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT:  ---
% OUTPUT: state = created state of filters bank:
%                 state.N
%                 state.freqs
%                 state.HF100_coeff ... state.LF3500_coeff
%                 state.HF100 ... state.LF3500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [state] = filter_bank_3_init

    K = 1.0/32768;
    
    state.freqs = [ 0, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1200, 1400, 1600, 1800, 2000, 2400, 2800, 3200, 3600, 3990 ];
    state.N     = length(state.freqs);
    vy          = zeros(1,state.N);
    
    state.BF100_coeff  = K * [ 0,     -3,     -5,     -5,     -2,      2,      8,     17,     28,   41,     57,     75,     96,    119,    144,    172,    202,    234,  269,    305,    344,    384,    425,    469,    513,    559,    605,  653,    700,    748,    796,    844,    892,    938,    984,   1028, 1071,   1112,   1152,   1189,   1223,   1255,   1223,   1189,   1152, 1112,   1071,   1028,    984,    938,    892,    844,    796,    748,  700,    653,    605,    559,    513,    469,    425,    384,    344,  305,    269,    234,    202,    172,    144,    119,     96,     75,  57,     41,     28,     17,      8,      2,     -2,     -5,     -5,  -3,      0 ];
    state.BF100        = my_filter_init(state.BF100_coeff);
    
    state.BF200_coeff  = K * [ 0,      0,     -6,    -19,    -38,    -64,    -96,   -133,   -176,  -222,   -271,   -321,   -371,   -419,   -464,   -503,   -535,   -559,  -573,   -574,   -563,   -539,   -499,   -445,   -375,   -291,   -193,   -81,     42,    176,    318,    466,    617,    769,    918,   1062,  1198,   1323,   1433,   1526,   1600,   1652,   1600,   1526,   1433,  1323,   1198,   1062,    918,    769,    617,    466,    318,    176,    42,    -81,   -193,   -291,   -375,   -445,   -499,   -539,   -563,  -574,   -573,   -559,   -535,   -503,   -464,   -419,   -371,   -321,  -271,   -222,   -176,   -133,    -96,    -64,    -38,    -19,     -6,    0,      0 ];
    state.BF200        = my_filter_init(state.BF200_coeff);
    
    state.BF300_coeff  = K * [ 0,      0,     11,     32,     63,    102,    147,    194,    241,   281,    312,    329,    328,    308,    264,    198,    109,      0,  -126,   -264,   -408,   -552,   -687,   -806,   -901,   -966,   -993,  -979,   -920,   -816,   -667,   -477,   -252,      0,    270,    548,  820,   1076,   1301,   1486,   1619,   1693,   1619,   1486,   1301,  1076,    820,    548,    270,      0,   -252,   -477,   -667,   -816,  -920,   -979,   -993,   -966,   -901,   -806,   -687,   -552,   -408,  -264,   -126,      0,    109,    198,    264,    308,    328,    329,   312,    281,    241,    194,    147,    102,     63,     32,     11,    0,      0 ];
    state.BF300        = my_filter_init(state.BF300_coeff);
    
    state.BF400_coeff  = K * [ 0,      0,    -15,    -44,    -83,   -129,   -175,   -211,   -232,   -229,   -198,   -137,    -47,     68,    200,    338,    468,    577,    650,    676,    646,    556,    406,    205,    -36,   -300,   -566,   -811,  -1012,  -1147,  -1200,  -1160,  -1023,   -793,   -483,   -113,    290,    695,   1070,   1381,   1600,   1704,   1600,   1381,   1070,    695,    290,   -113,   -483,   -793,  -1023,  -1160,  -1200,  -1147,  -1012,   -811,   -566,   -300,    -36,    205,    406,    556,    646,   676,    650,    577,    468,    338,    200,     68,    -47,   -137,  -198,   -229,   -232,   -211,   -175,   -129,    -83,    -44,    -15,     0,      0 ];
    state.BF400        = my_filter_init(state.BF400_coeff);
    
    state.BF500_coeff  = K * [ 0,      0,     19,     54,     99,    144,    175,    181,    153,    88,    -13,   -138,   -271,   -391,   -477,   -508,   -470,   -358,  -177,     55,    311,    557,    758,    878,    893,    789,    568,   250,   -131,   -529,   -890,  -1163,  -1305,  -1287,  -1099,   -755,  -291,    240,    772,   1235,   1564,   1709,   1564,   1235,    772,   240,   -291,   -755,  -1099,  -1287,  -1305,  -1163,   -890,   -529,  -131,    250,    568,    789,    893,    878,    758,    557,    311,    55,   -177,   -358,   -470,   -508,   -477,   -391,   -271,   -138,   -13,     88,    153,    181,    175,    144,     99,     54,     19,     0,      0 ];
    state.BF500        = my_filter_init(state.BF500_coeff);
    
    state.BF600_coeff  = K * [ 0,      0,    -23,    -64,   -110,   -144,   -149,   -111,    -29,    88,    218,    333,    399,    392,    298,    122,   -110,   -358,   -570,   -696,   -697,   -558,   -289,     69,    454,    790,   1004,   1041,    878,    529,     48,   -483,   -960,  -1289,  -1392,  -1234,   -829,   -241,    430,   1056,   1516,   1711,   1516,   1056,    430,   -241,   -829,  -1234,  -1392,  -1289,   -960,   -483,     48,    529,    878,   1041,   1004,    790,    454,     69,   -289,   -558,   -697,   -696,   -570,   -358,   -110,    122,    298,    392,    399,    333,   218,     88,    -29,   -111,   -149,   -144,   -110,    -64,    -23,    0,      0 ];
    state.BF600        = my_filter_init(state.BF600_coeff);
    
    state.BF700_coeff  = K * [ 0,      0,     27,     71,    114,    130,     99,     17,   -104,  -230,   -320,   -333,   -247,    -69,    167,    398,    555,    580,   444,    163,   -202,   -558,   -805,   -858,   -683,   -302,    200,   696,   1050,   1153,    954,    483,   -154,   -797,  -1274,  -1444,  -1242,   -699,     62,    850,   1457,   1713,   1457,    850,     62,   -699,  -1242,  -1444,  -1274,   -797,   -154,    483,    954,   1153,  1050,    696,    200,   -302,   -683,   -858,   -805,   -558,   -202,   163,    444,    580,    555,    398,    167,    -69,   -247,   -333,  -320,   -230,   -104,     17,     99,    130,    114,     71,     27,    0,      0 ];
    state.BF700        = my_filter_init(state.BF700_coeff);
    
    state.BF800_coeff  = K * [ 0,      0,    -30,    -77,   -112,   -103,    -35,     82,    206,    285,    268,    138,    -78,   -311,   -472,   -484,   -315,      0,    363,    646,    730,    559,    163,   -338,   -773,   -977,   -852,  -410,    219,    826,   1192,   1166,    728,      0,   -780,  -1339,  -1466,  -1089,   -309,    623,   1390,   1713,   1390,    623,   -309,  -1089,  -1466,  -1339,   -780,      0,    728,   1166,   1192,    826,   219,   -410,   -852,   -977,   -773,   -338,    163,    559,    730,   646,    363,      0,   -315,   -484,   -472,   -311,    -78,    138,   268,    285,    206,     82,    -35,   -103,   -112,    -77,    -30,    0,      0 ];
    state.BF800        = my_filter_init(state.BF800_coeff);
    
    state.BF900_coeff  = K * [ 0,      0,     34,     81,    104,     66,    -35,   -162,   -248,   -230,    -87,    138,    349,    435,    327,     41,   -315,   -580,   -614,   -365,     88,    559,    831,    753,    322,   -302,   -852,  -1069,   -823,   -183,    594,   1167,   1261,    798,    -55,   -942,  -1467,  -1373,   -664,    380,   1313,   1714,   1313,    380,   -664,  -1373,  -1467,   -942,    -55,    798,   1261,   1167,    594,   -183,  -823,  -1069,   -852,   -302,    322,    753,    831,    559,     88,  -365,   -614,   -580,   -315,     41,    327,    435,    349,    138,   -87,   -230,   -248,   -162,    -35,     66,    104,     81,     34,    0,      0 ];
    state.BF900        = my_filter_init(state.BF900_coeff);
    
    state.BF1000_coeff = K * [ 0,      0,    -37,    -84,    -90,    -23,     99,    207,    217,   88,   -135,   -333,   -375,   -200,    131,    447,    556,    359,   -77,   -532,   -744,   -559,    -33,    574,    924,    791,    200,   -561,  -1079,  -1041,   -421,    483,   1190,   1291,    686,   -339,  -1244,  -1522,   -981,    128,   1228,   1714,   1228,    128,   -981,  -1522,  -1244,   -339,    686,   1291,   1190,    483,   -421,  -1041,  -1079,   -561,    200,    791,    924,    574,    -33,   -559,   -744,   -532,    -77,    359,    556,    447,    131,   -200,   -375,   -333,   -135,     88,    217,    207,     99,    -23,    -90,    -84,    -37,    0,      0 ];
    state.BF1000       = my_filter_init(state.BF1000_coeff);
    
    state.BF1200_coeff = K * [ 0,      0,     -2,      1,     14,     26,     16,    -28,    -80,   -87,    -11,    119,    204,    143,    -67,   -297,   -354,   -135,   258,    547,    468,      0,   -570,   -809,   -465,    298,    960,    993,    278,   -746,  -1341,  -1006,    118,   1273,   1601,    780,   -684,  -1764,  -1636,   -310,   1322,   2089,   1322,   -310,  -1636,  -1764,   -684,    780,   1601,   1273,    118,  -1006,  -1341,   -746,  278,    993,    960,    298,   -465,   -809,   -570,      0,    468,  547,    258,   -135,   -354,   -297,    -67,    143,    204,    119,  -11,    -87,    -80,    -28,     16,     26,     14,      1,     -2,    0,      0 ];
    state.BF1200       = my_filter_init(state.BF1200_coeff);
    
    state.BF1400_coeff = K * [ 0,      0,     -1,      4,     16,     16,    -16,    -60,    -53,   33,    132,    119,    -48,   -232,   -218,     52,    354,    354,   -39,   -493,   -525,      0,    639,    730,     70,   -780,   -960, -174,    906,   1207,    314,  -1006,  -1457,   -486,   1070,   1697,  684,  -1090,  -1913,   -899,   1064,   2090,   1064,   -899,  -1913, -1090,    684,   1697,   1070,   -486,  -1457,  -1006,    314,   1207,   906,   -174,   -960,   -780,     70,    730,    639,      0,   -525,  -493,    -39,    354,    354,     52,   -218,   -232,    -48,    119,   132,     33,    -53,    -60,    -16,     16,     16,      4,     -1,    0,      0 ];
    state.BF1400       = my_filter_init(state.BF1400_coeff);
    
    state.BF1600_coeff = K * [ 0,      0,     -1,      6,     15,      0,    -39,    -43,     31,   107,     52,   -119,   -189,      0,    265,    236,   -147,   -437,  -189,    391,    569,      0,   -692,   -579,    341,    964,    398, -789,  -1101,      0,   1243,   1006,   -573,  -1573,   -630,   1215, 1652,      0,  -1773,  -1400,    779,   2090,    779,  -1400,  -1773,   0,   1652,   1215,   -630,  -1573,   -573,   1006,   1243,      0, -1101,   -789,    398,    964,    341,   -579,   -692,      0,    569,   391,   -189,   -437,   -147,    236,    265,      0,   -189,   -119,   52,    107,     31,    -43,    -39,      0,     15,      6,     -1,   0,      0 ];
    state.BF1600       = my_filter_init(state.BF1600_coeff);
    
    state.BF1800_coeff = K * [ 0,      0,     -1,      7,     11,    -16,    -39,      9,     82,    33,   -116,   -119,    107,    232,    -23,   -329,   -147,    354,   376,   -251,   -599,      0,    728,    372,   -677,   -780,    398,   1101,     94,  -1207,   -703,   1006,   1278,   -486,  -1642,   -269,   1652,   1090,  -1246,  -1764,    475,   2090,    475,  -1764,  -1246,   1090,   1652,   -269,  -1642,   -486,   1278,   1006,   -703,  -1207,    94,   1101,    398,   -780,   -677,    372,    728,      0,   -599,  -251,    376,    354,   -147,   -329,    -23,    232,    107,   -119,  -116,     33,     82,      9,    -39,    -16,     11,      7,     -1,    0,      0 ];
    state.BF1800       = my_filter_init(state.BF1800_coeff);
    
    state.BF2000_coeff = K * [ 0,      0,      0,      8,      4,    -26,    -16,     54,     43,   -87,    -88,    119,    155,   -143,   -245,    151,    355,   -135,  -480,     87,    614,      0,   -747,   -128,    866,    298,   -960,  -506,   1016,    746,  -1023,  -1006,    973,   1273,   -861,  -1531,   684,   1764,   -448,  -1955,    160,   2090,    160,  -1955,   -448,  1764,    684,  -1531,   -861,   1273,    973,  -1006,  -1023,    746,   1016,   -506,   -960,    298,    866,   -128,   -747,      0,    614,    87,   -480,   -135,    355,    151,   -245,   -143,    155,    119,   -88,    -87,     43,     54,    -16,    -26,      4,      8,      0,   0,      0 ];
    state.BF2000       = my_filter_init(state.BF2000_coeff);
    
    state.BF2400_coeff = K * [ 0,      0,      1,     13,    -13,    -37,     48,     55,   -108,   -47,    177,      0,   -227,     77,    232,   -154,   -180,    190,    91,   -143,    -13,      0,     16,    211,   -164,   -418,    488,   516,   -963,   -400,   1498,      0,  -1953,    683,   2171,  -1562,  -2027,   2477,   1470,  -3227,   -551,   3626,   -551,  -3227,   1470,   2477,  -2027,  -1562,   2171,    683,  -1953,      0,   1498,   -400,   -963,    516,    488,   -418,   -164,    211,     16,      0,    -13,   -143,     91,    190,   -180,   -154,    232,     77,   -227,      0,   177,    -47,   -108,     55,     48,    -37,    -13,     13,      1,    0,      0 ];
    state.BF2400       = my_filter_init(state.BF2400_coeff);
    
    state.BF2800_coeff = K * [ 0,      0,      2,      8,    -27,     14,     48,    -89,     19,   122,   -160,      0,    205,   -201,    -41,    250,   -180,    -72,   198,    -88,    -38,      0,     46,    131,   -356,    160,    488,  -835,    169,   1047,  -1351,      0,   1761,  -1787,   -381,   2527, -2027,   -946,   3197,  -1994,  -1599,   3625,  -1599,  -1994,   3197,  -946,  -2027,   2527,   -381,  -1787,   1761,      0,  -1351,   1047,  169,   -835,    488,    160,   -356,    131,     46,      0,    -38,  -88,    198,    -72,   -180,    250,    -41,   -201,    205,      0,  -160,    122,     19,    -89,     48,     14,    -27,      8,      2,   0,      0 ];
    state.BF2800       = my_filter_init(state.BF2800_coeff);
    
    state.BF3200_coeff = K * [ 0,      0,      3,      0,    -20,     46,    -48,      0,     86,  -151,    127,      0,   -163,    248,   -184,      0,    180,   -234,   141,      0,    -59,      0,     72,      0,   -255,    517,   -488,   0,    764,  -1293,   1072,      0,  -1397,   2207,  -1722,      0,  2026,  -3059,   2288,      0,  -2490,   3624,  -2490,      0,   2288, -3059,   2026,      0,  -1722,   2207,  -1397,      0,   1072,  -1293,   764,      0,   -488,    517,   -255,      0,     72,      0,    -59,     0,    141,   -234,    180,      0,   -184,    248,   -163,      0,   127,   -151,     86,      0,    -48,     46,    -20,      0,      3,    0,      0 ];
    state.BF3200       = my_filter_init(state.BF3200_coeff);
    
    state.BF3600_coeff = K * [ 0,      0,      4,     -8,      4,     14,    -48,     89,   -120,   122,    -81,      0,    104,   -201,    256,   -249,    180,    -72,  -31,     88,    -75,      0,     91,   -130,     56,    159,   -487,   833,  -1064,   1044,   -687,      0,    895,  -1782,   2400,  -2520,   2021,   -943,   -505,   1989,  -3131,   3616,  -3131,   1989,   -505,   -943,   2021,  -2520,   2400,  -1782,    895,      0,   -687,   1044,  -1064,    833,   -487,    159,     56,   -130,     91,      0,    -75,    88,    -31,    -72,    180,   -249,    256,   -201,    104,      0,   -81,    122,   -120,     89,    -48,     14,      4,     -8,      4,    0,      0 ];
    state.BF3600       = my_filter_init(state.BF3600_coeff);
    
    state.BF3990_coeff = K * [ 0,     -2,      9,    -19,     32,    -46,     59,    -68,     70,  -64,     48,    -23,     -9,     47,    -84,    117,   -140,    147, -134,     98,    -38,    -45,    144,   -253,    362,   -458,    527, -557,    534,   -448,    293,    -66,   -231,    589,   -997,   1435, -1883,   2315,  -2708,   3036,  -3279,   3418,  -3279,   3036,  -2708,  2315,  -1883,   1435,   -997,    589,   -231,    -66,    293,   -448,  534,   -557,    527,   -458,    362,   -253,    144,    -45,    -38,   98,   -134,    147,   -140,    117,    -84,     47,     -9,    -23,   48,    -64,     70,    -68,     59,    -46,     32,    -19,      9,   -2,      0 ];
    state.BF3990       = my_filter_init(state.BF3990_coeff);

return
